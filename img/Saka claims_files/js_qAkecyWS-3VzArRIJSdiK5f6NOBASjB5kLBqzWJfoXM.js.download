(function(Drupal,$,gigya,settings){Drupal.behaviors.gigya={attach:function(context){let cookieSettings={path:'/',domain:window.location.hostname.split(/\.(.+)?/)[1]};let isMember=false;let setFirstName=function(firstName){$('[data-js-gigya-name]').text(firstName);};let setIsMember=function(loginIds){isMember=(loginIds.hasOwnProperty('username')&&loginIds.username.match(/^\d+$/));};const setGuidCookie=function(guid){let guidCookie=$.cookie('guid');if(typeof guidCookie==='undefined'||guidCookie===null){$.cookie('guid',guid,cookieSettings);}};const getGigyaPointsCookie=function(){const gupointsCookie=$.cookie('gupoints');if(gupointsCookie==='-'){$('[data-js-gigya-points]').text('');}
else{$('[data-js-gigya-points]').text('('+gupointsCookie+' points)');}};const getQuery=function(){let query={};let queryString=window.location.search;if(typeof queryString!=='undefined'){let queryParams=queryString.substring(1).split('&');for(let i=0;i<queryParams.length;i++){let queryKeyValue=queryParams[i].split('=');query[queryKeyValue[0]]=(typeof queryKeyValue[1]!=='undefined')?queryKeyValue[1]:'';}}
return query;};const showResetPassword=function(){gigya.accounts.showScreenSet({screenSet:Drupal.behaviors.gigya.getScreenSetId('RegistrationLogin'),startScreen:'gigya-reset-password-screen',onAfterSubmit:(function(){window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'gigyaPasswordReset'});}),});};const showResetPasswordIfRequired=function(){const query=getQuery();if(typeof query.pwrt!=='undefined'){showResetPassword();}};const setLoggedIn=function(guid,firstName,loginIds){if(!drupalSettings.gigya.loggedIn){setFirstName(firstName);setIsMember(loginIds);setGuidCookie(guid);$('body').addClass('gigya-logged-in');$('.js-gigya-login-temp').remove();Drupal.behaviors.gigya.bindLoginAccess(context);let gupointsCookie=$.cookie('gupoints');if(typeof gupointsCookie==='undefined'||gupointsCookie===null){Drupal.behaviors.gigyaUserPoints.checkPoints();}else{getGigyaPointsCookie();}
Drupal.behaviors.swrveNotifications.createInstance();}
drupalSettings.gigya.loggedIn=true;};const MEMBERSHIP_TYPES={Anonymous:'Anonymous',Free:'Known (free)',Paid:'Known (paid)'}
const processExistingLoginResponse=function(response){window.dataLayer=window.dataLayer||[];if(response.errorCode===0){setLoggedIn(response.UID,response.profile.firstName,response.loginIDs);drupalSettings.gigya.loggedIn=true;if(response.data){const teamPreference=response.data.team_preference;const membershipTier=response.data.membership_tier;window.dataLayer.push({'event':'gigyaUserTeamPreference','label':teamPreference||'',});window.dataLayer.push({'event':'gigyaUserMembership','label':membershipTier&&membershipTier!==''?MEMBERSHIP_TYPES.Paid:MEMBERSHIP_TYPES.Free,});}
return;}
window.dataLayer.push({'event':'gigyaUserMembership','label':MEMBERSHIP_TYPES.Anonymous,});Drupal.behaviors.gigya.bindLoginEvents(context);Drupal.behaviors.gigya.removeGuidCookie(cookieSettings);Drupal.behaviors.gigya.removeGigyaPointsCookie();};const checkGigyaForExistingLogin=function(){gigya.accounts.getAccountInfo({include:'data,profile,loginIDs',callback:processExistingLoginResponse});};checkGigyaForExistingLogin();window.addEventListener('load',function(){Drupal.behaviors.gigya.bindHandlers();showResetPasswordIfRequired();});},bindLoginAccess:function(context=document){$('[data-js-gigya-login="true"]',context).data('data-js-gigya-login','false');},bindHandlers:function(){gigya.socialize.addEventHandlers({onLogin:this.onLoginHandler,onLogout:this.onLogoutHandler});},bindLoginEvents:function(context=document){$('[data-js-gigya-login="true"]',context).unbind('click').bind('click',function(e){e.preventDefault();Drupal.behaviors.gigya.showLogin();});},getScreenSetId:function(screenSetName){return drupalSettings.gigya.screenset_collection_id+'-'+screenSetName;},forgotPasswordHandler:function(event){if(event.eventName==='beforeSubmit'&&event.form==='gigya-reset-password-form'){$.get("/reset-password-email",{email:event.formData.loginID});gigya.accounts.hideScreenSet({screenSet:this.getScreenSetId('RegistrationLogin')});gigya.accounts.showScreenSet({screenSet:this.getScreenSetId('RegistrationLogin'),startScreen:'gigya-forgot-password-success-screen',onBeforeSubmit:this.forgotPasswordHandler,onAfterSubmit:(function(){window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'gigyaPasswordReset'});}),});return false;}},getSignupData:function(e){if(e.screen==='gigya-login-screen'){window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'gigyaLoggedIn'});}
if(e.screen==='gigya-complete-registration-screen'){window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'gigyaSignUp'});}},showLogin:function(){gigya.accounts.showScreenSet({screenSet:this.getScreenSetId('RegistrationLogin'),startScreen:'gigya-login-screen',onAfterSubmit:this.getSignupData});window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'gigyaLoginScreen'});},onLoginHandler:function(){gigya.setSSOToken({redirectURL:window.location.href.split('#')[0]});},onLogoutHandler:function(){$('body').removeClass('gigya-logged-in');window.location.reload();},logOut:function(){Drupal.behaviors.terminateCloudpaySession.terminate();gigya.accounts.logout();Drupal.behaviors.gigya.removeGigyaPointsCookie();window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'gigyaLoggedOut'});},setGigyaPointsCookie:function(points){gigya.accounts.getAccountInfo({callback:(function(response){if(typeof response.profile!=='undefined'){if(points==='-'){$('[data-js-gigya-points]').text('');}
else{$('[data-js-gigya-points]').text('('+points+' points)');}
$.cookie('gupoints',points,{expires:1,path:'/',domain:window.location.hostname.split(/\.(.+)?/)[1],secure:true,});}}),});},showGigyaScreenset:function(member,set,screen,redirect,after){if(member&&redirect&&(typeof drupalSettings.gigya.membership_account_link!=='undefined')&&(set='ProfileUpdate')){window.open(drupalSettings.gigya.membership_account_link,'_blank');window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'memberEditProfile'});}else{gigya.accounts.showScreenSet({screenSet:drupalSettings.gigya.screenset_collection_id+'-'+set,startScreen:screen?screen:'',onAfterSubmit:!!after&&(function(response){$('[data-js-gigya-name]').text(response.profile.firstName);}),});if(typeof drupalSettings.modal!=='undefined'||drupalSettings.modal!==null){drupalSettings.modal.deactivate();}
window.dataLayer=window.dataLayer||[];window.dataLayer.push({'event':'digitalMemberEditProfile'});}},removeGuidCookie:function(cookieSettings){$.removeCookie('guid',cookieSettings);},removeGigyaPointsCookie:function(){$.removeCookie('gupoints',{expires:1,path:'/',domain:window.location.hostname.split(/\.(.+)?/)[1],secure:true,});},};})(Drupal,jQuery,gigya,(typeof drupalSettings.gigya!=='undefined')?drupalSettings.gigya:{screenset_collection_id:'Default'});;
(function($,once){var deprecatedMessageSuffix="is deprecated in Drupal 9.3.0 and will be removed in Drupal 10.0.0. Use the core/once library instead. See https://www.drupal.org/node/3158256";var originalJQOnce=$.fn.once;var originalJQRemoveOnce=$.fn.removeOnce;$.fn.once=function jQueryOnce(id){Drupal.deprecationError({message:"jQuery.once() ".concat(deprecatedMessageSuffix)});return originalJQOnce.apply(this,[id]);};$.fn.removeOnce=function jQueryRemoveOnce(id){Drupal.deprecationError({message:"jQuery.removeOnce() ".concat(deprecatedMessageSuffix)});return originalJQRemoveOnce.apply(this,[id]);};var drupalOnce=once;function augmentedOnce(id,selector,context){originalJQOnce.apply($(selector,context),[id]);return drupalOnce(id,selector,context);}
function remove(id,selector,context){originalJQRemoveOnce.apply($(selector,context),[id]);return drupalOnce.remove(id,selector,context);}
window.once=Object.assign(augmentedOnce,drupalOnce,{remove:remove});})(jQuery,once);;
